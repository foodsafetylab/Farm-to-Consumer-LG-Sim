#we want it to be a vector.
#extract it
words1<-words0[[1]]
ss<-"Friends of the Geese are hosting a memorial service Saturday for the 175 geese killed this week by the Urbana Park District in its 'charity harvest.'"
# separate out the words in the string
# We separate based on the white space. to split it into words
#One issue is that we still have punctiartion
words0<-str_split(ss, "\\s") #it creates a list
#we want it to be a vector.
#extract it
words1<-words0[[1]]
words1[1]
str_split(ss, "\\s", simplify = T)
#fix
t(str_split(ss, "\\s", simplify = T))
c(t(str_split(ss, "\\s", simplify = T)))
RentalsData <- read_delim("https://uofi.box.com/shared/static/1mi85x78tljopsjv36ap9bwcpqwi9rlv.txt", delim="\t")
RentalsData$`Mappable Address`
Coordinates<-str_split(RentalsData$`Mappable Address`, "\\\n", simplify = TRUE)
head(Coordinates, n=10)
Coordinates[,1] <- str_replace(Coordinates[,1],"1\\s2","1/2")
head(Coordinates)
gg <- group_by(RentalsData, Grade)
gg
RentalsData %>%
count(Grade)
RentalsData %>%
group_by(Grade) %>%
mutate(count_grade = n(), proportion_grade=count_grade/nrow(RentalsData))
RentalsData %>%
group_by(Grade) %>%
mutate(count_grade = n, proportion_grade=count_grade/nrow(RentalsData))
RentalsData %>%
group_by(Grade) %>%
mutate(count_grade = n(), proportion_grade=count_grade/nrow(RentalsData))
library(glue)
Gustavo_PS<-read_csv("PointSource.csv")
CPS_1<-read_csv("PointSourceCPS1.csv")
Gustavo_PS$seq<-rep(seq(1,10),500)
GPS_2<-Gustavo_PS %>%
group_by(Grabs, seq) %>%
summarize( mean_1= mean(Acceptance))%>%
group_by(Grabs) %>%
summarize(mean_2 = mean(mean_1),q2.5=quantile(mean_1, 0.025), q97.5=quantile(mean_1, 0.975) )
CPS<-CPS_1 %>%
group_by(param) %>%
summarize(mean = mean(Paccept), q2.5 = quantile(Paccept, 0.025), q97.5  = quantile(Paccept, 0.975))
ggplot(data = GPS_2) +
geom_ribbon(aes(x = Grabs, ymin = q2.5, ymax = q97.5, alpha = 0.3, ))+
geom_line(aes(x =Grabs , y = mean_2 )) +
geom_point(aes(x =Grabs , y = mean_2))+
labs(x = "Number of 3g Sample Point", y = "Probability of acceptance (2.5th - 97.5th percentile)")+
theme_bw()+
geom_pointrange(data =CPS,  aes(x=param,y = mean, ymin=q2.5, ymax=q97.5) ,colour="royalblue1", alpha=1, size=0.5, shape = 15)+
ggtitle("Point Source Contamination: Model Validation") +
theme(plot.title = element_text(hjust = 0.5))+
theme(text = element_text(size = 15))
library(tidyverse)
library(tidyverse)
Gustavo_PS<-read_csv("PointSource.csv")
CPS_1<-read_csv("PointSourceCPS1.csv")
Gustavo_PS$seq<-rep(seq(1,10),500)
GPS_2<-Gustavo_PS %>%
group_by(Grabs, seq) %>%
summarize( mean_1= mean(Acceptance))%>%
group_by(Grabs) %>%
summarize(mean_2 = mean(mean_1),q2.5=quantile(mean_1, 0.025), q97.5=quantile(mean_1, 0.975) )
GPS<-Gustavo_PS %>%
group_by(Grabs) %>%
summarize(mean = mean(Acceptance))
CPS<-CPS_1 %>%
group_by(param) %>%
summarize(mean = mean(Paccept), q2.5 = quantile(Paccept, 0.025), q97.5  = quantile(Paccept, 0.975))
ggplot(data = GPS_2) +
geom_ribbon(aes(x = Grabs, ymin = q2.5, ymax = q97.5, alpha = 0.3, ))+
geom_line(aes(x =Grabs , y = mean_2 )) +
geom_point(aes(x =Grabs , y = mean_2))+
labs(x = "Number of 3g Sample Point", y = "Probability of acceptance (2.5th - 97.5th percentile)")+
theme_bw()+
geom_pointrange(data =CPS,  aes(x=param,y = mean, ymin=q2.5, ymax=q97.5) ,colour="royalblue1", alpha=1, size=0.5, shape = 15)+
ggtitle("Point Source Contamination: Model Validation") +
theme(plot.title = element_text(hjust = 0.5))+
theme(text = element_text(size = 15))
#geom_point(data =CPS,  aes(x=param, y = mean), color = "blue", alpha=0.7, shape = 15)
Gustavo_PS<-read_csv("PointSource.csv")
CPS_1<-read_csv("PointSourceCPS1.csv")
Gustavo_PS$seq<-rep(seq(1,10),500)
setwd("~/GitHubFiles/CPS-Farm-to-Facility/Model")
library(tidyverse)
Gustavo_PS<-read_csv("PointSource.csv")
CPS_1<-read_csv("PointSourceCPS1.csv")
Gustavo_PS$seq<-rep(seq(1,10),500)
GPS_2<-Gustavo_PS %>%
group_by(Grabs, seq) %>%
summarize( mean_1= mean(Acceptance))%>%
group_by(Grabs) %>%
summarize(mean_2 = mean(mean_1),q2.5=quantile(mean_1, 0.025), q97.5=quantile(mean_1, 0.975) )
GPS<-Gustavo_PS %>%
group_by(Grabs) %>%
summarize(mean = mean(Acceptance))
CPS<-CPS_1 %>%
group_by(param) %>%
summarize(mean = mean(Paccept), q2.5 = quantile(Paccept, 0.025), q97.5  = quantile(Paccept, 0.975))
ggplot(data = GPS_2) +
geom_ribbon(aes(x = Grabs, ymin = q2.5, ymax = q97.5, alpha = 0.3, ))+
geom_line(aes(x =Grabs , y = mean_2 )) +
geom_point(aes(x =Grabs , y = mean_2))+
labs(x = "Number of 3g Sample Point", y = "Probability of acceptance (2.5th - 97.5th percentile)")+
theme_bw()+
geom_pointrange(data =CPS,  aes(x=param,y = mean, ymin=q2.5, ymax=q97.5) ,colour="royalblue1", alpha=1, size=0.5, shape = 15)+
ggtitle("Point Source Contamination: Model Validation") +
theme(plot.title = element_text(hjust = 0.5))+
theme(text = element_text(size = 15))
#geom_point(data =CPS,  aes(x=param, y = mean), color = "blue", alpha=0.7, shape = 15)
ggplot(data = GPS_2) +
geom_ribbon(aes(x = Grabs, ymin = q2.5, ymax = q97.5, alpha = 0.3 ))+
geom_line(aes(x =Grabs , y = mean_2 )) +
geom_point(aes(x =Grabs , y = mean_2))+
labs(x = "Number of 3g Sample Point", y = "Probability of acceptance (2.5th - 97.5th percentile)")+
theme_bw()+
geom_pointrange(data =CPS,  aes(x=param,y = mean, ymin=q2.5, ymax=q97.5) ,colour="royalblue1", alpha=1, size=0.5, shape = 15)+
ggtitle("Point Source Contamination: Model Validation") +
theme(plot.title = element_text(hjust = 0.5))+
theme(text = element_text(size = 15))
ggplot(data = GPS_2) +
geom_ribbon(aes(x = Grabs, ymin = q2.5, ymax = q97.5, alpha = 0.3 ))+
geom_line(aes(x =Grabs , y = mean_2 )) +
geom_point(aes(x =Grabs , y = mean_2))+
labs(x = "Number of 3g Sample Point", y = "Probability of acceptance (2.5th - 97.5th percentile)")+
theme_bw()+
geom_pointrange(data =CPS,  aes(x=param,y = mean, ymin=q2.5, ymax=q97.5) ,colour="royalblue1", alpha=1, size=0.5, shape = 15)+
ggtitle("Point Source Contamination: Model Validation") +
theme(plot.title = element_text(hjust = 0.5))+
theme(text = element_text(size = 15)) +
scale_fill_discrete(guide="none")
ggplot(data = GPS_2) +
geom_ribbon(aes(x = Grabs, ymin = q2.5, ymax = q97.5 ), alpha = 0.3)+
geom_line(aes(x =Grabs , y = mean_2 )) +
geom_point(aes(x =Grabs , y = mean_2))+
labs(x = "Number of 3g Sample Point", y = "Probability of acceptance (2.5th - 97.5th percentile)")+
theme_bw()+
geom_pointrange(data =CPS,  aes(x=param,y = mean, ymin=q2.5, ymax=q97.5) ,colour="royalblue1", alpha=1, size=0.5, shape = 15)+
ggtitle("Point Source Contamination: Model Validation") +
theme(plot.title = element_text(hjust = 0.5))+
theme(text = element_text(size = 15))
Gustavo_UN<-read_csv("Uniform_Validation.csv")
Gustavo_UN$seq<-rep(seq(1,10),2000)
CPS_2<-read_csv("CPSUniform.csv")
CPSU<-CPS_2 %>%
group_by(param, type) %>%
summarize(mean = mean(Paccept), q2.5 = quantile(Paccept, 0.025), q97.5  = quantile(Paccept, 0.975))
GUN<-Gustavo_UN %>%
group_by(Cont_Level, Grabs) %>%
summarize(mean = mean(Acceptance))
GUN_2<-Gustavo_UN %>%
group_by(Grabs,Cont_Level, seq) %>%
summarize( mean_1= mean(Acceptance))%>%
group_by(Grabs, Cont_Level) %>%
summarize(mean_2 = mean(mean_1),q2.5=quantile(mean_1, 0.025), q97.5=quantile(mean_1, 0.975) )
ggplot(data = GUN_2) +
geom_ribbon(aes(x = Grabs, ymin = q2.5, ymax = q97.5, fill =Cont_Level,alpha = 0.3,  ))+
geom_line(aes(x =Grabs , y = mean_2, color = Cont_Level ),size = 0.8) +
geom_point(aes(x =Grabs , y = mean_2,color = Cont_Level), size = 2.5)+
labs(x = "Number of 3g Sample Point", y = "Probability of acceptance (2.5th - 97.5th percentile)")+
theme_bw()+
geom_pointrange(data =CPSU,  aes(x=param,y = mean, ymin=q2.5, ymax=q97.5 ) ,color ="royalblue1"  , alpha=0.8, size=0.5, shape = 15)+
ggtitle("Uniform Contamination: Model Validation") +
theme(plot.title = element_text(hjust = 0.5))+
theme(text = element_text(size = 15))
ggplot(data = GUN_2) +
geom_ribbon(aes(x = Grabs, ymin = q2.5, ymax = q97.5, fill =Cont_Level  ),alpha = 0.3)+
geom_line(aes(x =Grabs , y = mean_2, color = Cont_Level ),size = 0.8) +
geom_point(aes(x =Grabs , y = mean_2,color = Cont_Level), size = 2.5)+
labs(x = "Number of 3g Sample Point", y = "Probability of acceptance (2.5th - 97.5th percentile)")+
theme_bw()+
geom_pointrange(data =CPSU,  aes(x=param,y = mean, ymin=q2.5, ymax=q97.5 ) ,color ="royalblue1"  , alpha=0.8, size=0.5, shape = 15)+
ggtitle("Uniform Contamination: Model Validation") +
theme(plot.title = element_text(hjust = 0.5))+
theme(text = element_text(size = 15))
Gustavo_UN<-read_csv("Uniform_Validation.csv")
Gustavo_UN$seq<-rep(seq(1,10),2000)
CPS_2<-read_csv("CPSUniform.csv")
CPSU<-CPS_2 %>%
group_by(param, type) %>%
summarize(mean = mean(Paccept), q2.5 = quantile(Paccept, 0.05), q97.5  = quantile(Paccept, 0.95))
GUN<-Gustavo_UN %>%
group_by(Cont_Level, Grabs) %>%
summarize(mean = mean(Acceptance))
GUN_2<-Gustavo_UN %>%
group_by(Grabs,Cont_Level, seq) %>%
summarize( mean_1= mean(Acceptance))%>%
group_by(Grabs, Cont_Level) %>%
summarize(mean_2 = mean(mean_1),q2.5=quantile(mean_1, 0.025), q97.5=quantile(mean_1, 0.975) )
ggplot(data = GUN_2) +
geom_ribbon(aes(x = Grabs, ymin = q2.5, ymax = q97.5, fill =Cont_Level  ),alpha = 0.3)+
geom_line(aes(x =Grabs , y = mean_2, color = Cont_Level ),size = 0.8) +
geom_point(aes(x =Grabs , y = mean_2,color = Cont_Level), size = 2.5)+
labs(x = "Number of 3g Sample Point", y = "Probability of acceptance (2.5th - 97.5th percentile)")+
theme_bw()+
geom_pointrange(data =CPSU,  aes(x=param,y = mean, ymin=q2.5, ymax=q97.5 ) ,color ="royalblue1"  , alpha=0.8, size=0.5, shape = 15)+
ggtitle("Uniform Contamination: Model Validation") +
theme(plot.title = element_text(hjust = 0.5))+
theme(text = element_text(size = 15))
Gustavo_UN<-read_csv("Uniform_Validation.csv")
Gustavo_UN$seq<-rep(seq(1,10),2000)
CPS_2<-read_csv("CPSUniform.csv")
CPSU<-CPS_2 %>%
group_by(param, type) %>%
summarize(mean = mean(Paccept), q2.5 = quantile(Paccept, 0.1), q97.5  = quantile(Paccept, 0.9))
GUN<-Gustavo_UN %>%
group_by(Cont_Level, Grabs) %>%
summarize(mean = mean(Acceptance))
GUN_2<-Gustavo_UN %>%
group_by(Grabs,Cont_Level, seq) %>%
summarize( mean_1= mean(Acceptance))%>%
group_by(Grabs, Cont_Level) %>%
summarize(mean_2 = mean(mean_1),q2.5=quantile(mean_1, 0.025), q97.5=quantile(mean_1, 0.975) )
ggplot(data = GUN_2) +
geom_ribbon(aes(x = Grabs, ymin = q2.5, ymax = q97.5, fill =Cont_Level  ),alpha = 0.3)+
geom_line(aes(x =Grabs , y = mean_2, color = Cont_Level ),size = 0.8) +
geom_point(aes(x =Grabs , y = mean_2,color = Cont_Level), size = 2.5)+
labs(x = "Number of 3g Sample Point", y = "Probability of acceptance (2.5th - 97.5th percentile)")+
theme_bw()+
geom_pointrange(data =CPSU,  aes(x=param,y = mean, ymin=q2.5, ymax=q97.5 ) ,color ="royalblue1"  , alpha=0.8, size=0.5, shape = 15)+
ggtitle("Uniform Contamination: Model Validation") +
theme(plot.title = element_text(hjust = 0.5))+
theme(text = element_text(size = 15))
Gustavo_UN<-read_csv("Uniform_Validation.csv")
Gustavo_UN$seq<-rep(seq(1,10),2000)
CPS_2<-read_csv("CPSUniform.csv")
CPSU<-CPS_2 %>%
group_by(param, type) %>%
summarize(mean = mean(Paccept), q2.5 = quantile(Paccept, 0.025), q97.5  = quantile(Paccept, 0.975))
GUN<-Gustavo_UN %>%
group_by(Cont_Level, Grabs) %>%
summarize(mean = mean(Acceptance))
GUN_2<-Gustavo_UN %>%
group_by(Grabs,Cont_Level, seq) %>%
summarize( mean_1= mean(Acceptance))%>%
group_by(Grabs, Cont_Level) %>%
summarize(mean_2 = mean(mean_1),q2.5=quantile(mean_1, 0.025), q97.5=quantile(mean_1, 0.975) )
ggplot(data = GUN_2) +
geom_ribbon(aes(x = Grabs, ymin = q2.5, ymax = q97.5, fill =Cont_Level  ),alpha = 0.3)+
geom_line(aes(x =Grabs , y = mean_2, color = Cont_Level ),size = 0.8) +
geom_point(aes(x =Grabs , y = mean_2,color = Cont_Level), size = 2.5)+
labs(x = "Number of 3g Sample Point", y = "Probability of acceptance (2.5th - 97.5th percentile)")+
theme_bw()+
geom_pointrange(data =CPSU,  aes(x=param,y = mean, ymin=q2.5, ymax=q97.5 ) ,color ="royalblue1"  , alpha=0.8, size=0.5, shape = 15)+
ggtitle("Uniform Contamination: Model Validation") +
theme(plot.title = element_text(hjust = 0.5))+
theme(text = element_text(size = 15))
Gustavo_UN<-read_csv("Uniform_Validation.csv")
Gustavo_UN$seq<-rep(seq(1,10),2000)
CPS_2<-read_csv("CPSUniform.csv")
CPSU<-CPS_2 %>%
group_by(param, type) %>%
summarize(mean = mean(Paccept), q2.5 = quantile(Paccept, 0.025), q97.5  = quantile(Paccept, 0.975))
GUN<-Gustavo_UN %>%
group_by(Cont_Level, Grabs) %>%
summarize(mean = mean(Acceptance))
GUN_2<-Gustavo_UN %>%
group_by(Grabs,Cont_Level, seq) %>%
summarize( mean_1= mean(Acceptance))%>%
group_by(Grabs, Cont_Level) %>%
summarize(mean_2 = mean(mean_1),q2.5=quantile(mean_1, 0.025), q97.5=quantile(mean_1, 0.975) )
ggplot(data = GUN_2) +
geom_ribbon(aes(x = Grabs, ymin = q2.5, ymax = q97.5, fill =Cont_Level  ),alpha = 0.3)+
geom_line(aes(x =Grabs , y = mean_2, color = Cont_Level ),size = 0.8) +
geom_point(aes(x =Grabs , y = mean_2,color = Cont_Level), size = 2.5)+
labs(x = "Number of 3g Sample Point", y = "Probability of acceptance (2.5th - 97.5th percentile)")+
theme_bw()+
geom_pointrange(data =CPSU,  aes(x=param,y = mean, ymin=q2.5, ymax=q97.5 ) ,color ="royalblue1"  , alpha=0.8, size=0.5, shape = 15)+
ggtitle("Uniform Contamination: Model Validation") +
theme(plot.title = element_text(hjust = 0.5))+
theme(text = element_text(size = 15))
Data <- read.csv("SensitivityOut03-22.csv", stringsAsFactors = TRUE)
View(Data)
Data_x<-Data[-c(1,50,51)]
PCC1<-pcc(X = Data_x, y=Data$TotalCFUFP, rank =TRUE, conf = 0.8, nboot = 1000)
library(ppcor)
library(sensitivity)
library(ggplot2)
library(randomForest)
library(forcats)
PCC1<-pcc(X = Data_x, y=Data$TotalCFUFP, rank =TRUE, conf = 0.8, nboot = 1000)
#8 Visuals , remaing the columns to that no error in ggplot
names(PCC1$PRCC)=c("original", "bias" ,"std.error", "minci","maxci")
#Ggplot, here is similar to a tornado plot. Also there are error bars on the 95th percentile
Sens_DF<-PCC1$PRCC
Sens_DF$Cateogry
Cateogries<-c(
"Contamination Scen",# "InitialCont" ,
"Contamination Scen",#"ClusterSize",
"Time",#Time_CE_H",
"Reduction",#"Total_CE_H_Dieoff",
#Pre-cooling
"Time",#"Time_H_PC",
"Temperature",#"Temp_H_PC",
"Time",#"Time Precooling",
"Time",#"Temp Precooling",
"Intervention",#"Pre_cooling",
#Receiving
"Time",#"Time_Storage_R",
"Temperature",#"Temp_Storage_R",
#Processing Factor
"Reduction",#"PreWashRed",
"Reduction",#"PreWashYN",
"Reduction",#"WashingYN",
"Reduction", #"ChSpray_eff"
"Processing",#"Tr_Sh_P",
"Processing",#"Tr_P_Sh",
"Reduction",#"Sh_Compliance",
"Reduction",#"Sh_San_freq",
"Reduction",#"Sh_San_Eff",
"Processing",#"Tr_Cv_P",
"Processing",#"Tr_P_Cv",
"Reduction",#"Cv_Compliance",
"Reduction",#"Cv_San_freq",
"Reduction",#"Cv_San_Eff",
"Processing",#"Tr_St_P",
"Processing",#"Tr_P_St",
"Reduction",#"St_Compliance",
"Reduction",#"St_San_freq",
"Reduction",#"St_San_Eff",
"Processing",#"Tr_C_P",
"Processing",#"Tr_P_C",
"Reduction",#"C_Compliance",
"Reduction",#"C_San_freq",
"Reduction",# "C_San_Eff",
"Time",
"Temperature",
"Time",
"Temperature",
"Time",
"Temperature",
"Sampling",
"Sampling",
"Sampling",
"Sampling",
"Sampling",
"Sampling",
"Sampling",
)
Cateogries<-c(
"Contamination Scen",# "InitialCont" ,
"Contamination Scen",#"ClusterSize",
"Time",#Time_CE_H",
"Reduction",#"Total_CE_H_Dieoff",
#Pre-cooling
"Time",#"Time_H_PC",
"Temperature",#"Temp_H_PC",
"Time",#"Time Precooling",
"Time",#"Temp Precooling",
"Intervention",#"Pre_cooling",
#Receiving
"Time",#"Time_Storage_R",
"Temperature",#"Temp_Storage_R",
#Processing Factor
"Reduction",#"PreWashRed",
"Reduction",#"PreWashYN",
"Reduction",#"WashingYN",
"Reduction", #"ChSpray_eff"
"Processing",#"Tr_Sh_P",
"Processing",#"Tr_P_Sh",
"Reduction",#"Sh_Compliance",
"Reduction",#"Sh_San_freq",
"Reduction",#"Sh_San_Eff",
"Processing",#"Tr_Cv_P",
"Processing",#"Tr_P_Cv",
"Reduction",#"Cv_Compliance",
"Reduction",#"Cv_San_freq",
"Reduction",#"Cv_San_Eff",
"Processing",#"Tr_St_P",
"Processing",#"Tr_P_St",
"Reduction",#"St_Compliance",
"Reduction",#"St_San_freq",
"Reduction",#"St_San_Eff",
"Processing",#"Tr_C_P",
"Processing",#"Tr_P_C",
"Reduction",#"C_Compliance",
"Reduction",#"C_San_freq",
"Reduction",# "C_San_Eff",
"Time",
"Temperature",
"Time",
"Temperature",
"Time",
"Temperature",
"Sampling",
"Sampling",
"Sampling",
"Sampling",
"Sampling",
"Sampling",
"Sampling"
)
Column_Names<-c(
"Initial Contamination",# "InitialCont" ,
"Cluster Size",#"ClusterSize",
"Time CE-H",#Time_CE_H",
"Total Pre-Harvest Die-off",#"Total_CE_H_Dieoff",
#Pre-cooling
"Time H-Pre-cooling",#"Time_H_PC",
"Temperature H-Pre-cooling",#"Temp_H_PC",
"Length Pre-cooling",#"Time Precooling",
"Teperature Pre-cooling",#"Temp Precooling",
"Pre-cooling ON",#"Pre_cooling",
#Receiving
"Time Storage- Receiving",#"Time_Storage_R",
"Storage Temperature",#"Temp_Storage_R",
#Processing Factor
"Pre-Wash Reduction",#"PreWashRed",
"Pre-Wash ON",#"PreWashYN",
"Chlorinated Wash ON",#"WashingYN",
"Pre-Wash Efficacy", #"ChSpray_eff"
"Tr_Sh_P",
"Tr_P_Sh",
"Sh_Compliance",
"Sh_San_freq",
"Sh_San_Eff",
"Tr_Cv_P",
"Tr_P_Cv",
"Cv_Compliance",
"Cv_San_freq",
"Cv_San_Eff",
"Tr_St_P",
"Tr_P_St",
"St_Compliance",
"St_San_freq",
"St_San_Eff",
"Tr_C_P",
"Tr_P_C",
"C_Compliance",
"C_San_freq",
"C_San_Eff",
"Time Post Processing Storage",
"Temperature Post P Storage",
"Time Transportation to C",
"Temperature Transportation to C",
"Time Consumer Storage",
"Temperature Consumer Storage",
"PHS 4 days ON",
"PHS 4 Hours ON",
"PHS 4 Intense ON",
"Harvest S ON",
"Receiving S ON",
"Finished Product S ON",
"Consumer S ON"
)
Sens_DF$Cateogry <-Cateogries
rownames(Sens_DF)<-Column_Names
ggplot(data = Sens_DF, aes(x=fct_reorder(rownames(Sens_DF), abs(original)),y=original , fill = Cateogry))+
geom_bar(stat = "identity", position = "identity")+
geom_errorbar(aes(ymin=minci, ymax=maxci), width=.1,col="blue")+
ylab("Partial Correlation Coefficient")+
xlab("Model Input")+
ggtitle("Sensitivity Analysis on Final CFU in System")+
coord_flip()+
theme(plot.title = element_text(hjust = 0.5))+
theme(text = element_text(size=13))
Sens_DF %>%
arrange(des(abs(original)))
Sens_DF %>%
arrange(desc(abs(original)))
Sens_DF %>%
arrange(desc(abs(original)))
slice_head(n=20)
Sens_DF %>%
arrange(desc(abs(original))) %>%
slice_head(n=20)
Sens_DF_T20<-Sens_DF %>%
arrange(desc(abs(original))) %>%
slice_head(n=20)
ggplot(data = Sens_DF_T20, aes(x=fct_reorder(rownames(Sens_DF), abs(original)),y=original , fill = Cateogry))+
geom_bar(stat = "identity", position = "identity")+
geom_errorbar(aes(ymin=minci, ymax=maxci), width=.1,col="blue")+
ylab("Partial Correlation Coefficient")+
xlab("Model Input")+
ggtitle("Sensitivity Analysis on Final CFU in System")+
coord_flip()+
theme(plot.title = element_text(hjust = 0.5))+
theme(text = element_text(size=13))
ggplot(data = Sens_DF_T20, aes(x=fct_reorder(rownames(Sens_DF_T20), abs(original)),y=original , fill = Cateogry))+
geom_bar(stat = "identity", position = "identity")+
geom_errorbar(aes(ymin=minci, ymax=maxci), width=.1,col="blue")+
ylab("Partial Correlation Coefficient")+
xlab("Model Input")+
ggtitle("Sensitivity Analysis on Final CFU in System")+
coord_flip()+
theme(plot.title = element_text(hjust = 0.5))+
theme(text = element_text(size=13))
Sens_DF_T25<-Sens_DF %>%
arrange(desc(abs(original))) %>%
slice_head(n=25)
ggplot(data = Sens_DF_T25, aes(x=fct_reorder(rownames(Sens_DF_T25), abs(original)),y=original , fill = Cateogry))+
geom_bar(stat = "identity", position = "identity")+
geom_errorbar(aes(ymin=minci, ymax=maxci), width=.1,col="blue")+
ylab("Partial Correlation Coefficient")+
xlab("Model Input")+
ggtitle("Sensitivity Analysis on Final CFU in System")+
coord_flip()+
theme(plot.title = element_text(hjust = 0.5))+
theme(text = element_text(size=13))
ggplot(data = Sens_DF, aes(x=fct_reorder(rownames(Sens_DF), abs(original)),y=original , fill = Cateogry))+
geom_bar(stat = "identity", position = "identity")+
geom_errorbar(aes(ymin=minci, ymax=maxci), width=.1,col="blue")+
ylab("Partial Correlation Coefficient")+
xlab("Model Input")+
ggtitle("Sensitivity Analysis on Final CFU in System")+
coord_flip()+
theme(plot.title = element_text(hjust = 0.5))+
theme(text = element_text(size=13))
