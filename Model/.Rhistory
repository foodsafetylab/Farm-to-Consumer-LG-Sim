count()
dt %>%
group_by(color) %>%
count()
dt
dt %>%
group_by(color) %>%
count() %>%
mutate(proportion = n/10)
dt %>%
group_by(weight) %>%
count()%>%
mutate(proportion = n/10)
dt %>%
group_by(weight, length) %>%
count()%>%
mutate(proportion = n/10)
dt %>%
filter(color == "red") %>%
group_by(weight) %>%
count()%>%
mutate(proportion = n/10)
dt %>%
group_by(weight , length, color) %>%
count()%>%
mutate(proportion = n/10)
dt %>%
group_by(weight ,length, color) %>%
count()%>%
mutate(proportion = n/10)
color = c("red","green", "blue")
group = c("control", "experiment")
both  = color*group
cross <- function(x, y = x) {
result <- list()
for (a in unique(x)) {
for (b in unique(y)) {
result <- append(result, list(list(left = a, right = b)))
}
}
result
}
cross(group, color)
color = sample(c(1,2,3), 1, replace = TRUE)
group = sample(c(1,2), 1, replace = TRUE)
both = color*group
Data <- read.csv("SensitivityOut03-14.csv", stringsAsFactors = TRUE)
setwd("~/GitHubFiles/CPS-Farm-to-Facility/Model")
Data <- read.csv("SensitivityOut03-14.csv", stringsAsFactors = TRUE)
Data_x<-Data[-c(1,36,37)]
PCC1<-pcc(X = Data_x, y=Data$TotalCFUFP, rank =TRUE, conf = 0.8, nboot = 100)
library(ppcor)
library(sensitivity)
library(ggplot2)
library(randomForest)
library(forcats)
PCC1<-pcc(X = Data_x, y=Data$TotalCFUFP, rank =TRUE, conf = 0.8, nboot = 100)
#Ggplot, here is similar to a tornado plot. Also there are error bars on the 95th percentile
Sens_DF<-PCC1$PRCC
View(Sens_DF)
Sens_DF$Cateogry <-Cateogries
Cateogries<-c(
"Field Setup",# "InitialCont" ,
"Contamination Scen",#"ClusterSize",
"Reduction",#Time_CE_H",
"Reduction",#"Total_CE_H_Dieoff",
#Pre-cooling
"Time",#"Time_H_PC",
"Temperature","Temp_H_PC",
"Time","Time Precooling",
"Time","Temp Precooling",
"Intervention","Pre_cooling",
#Receiving
"Time",#"Time_Storage_R",
"Temperature",#"Temp_Storage_R",
#Processing Factor
"Reduction",#"PreWashRed",
"Reduction",#"PreWashYN",
"Reduction",#"WashingYN",
"Processing",#"Tr_Sh_P",
"Processing",#"Tr_P_Sh",
"Reduction",#"Sh_Compliance",
"Reduction",#"Sh_San_freq",
"Reduction",#"Sh_San_Eff",
"Processing",#"Tr_Cv_P",
"Processing",#"Tr_P_Cv",
"Reduction",#"Cv_Compliance",
"Reduction",#"Cv_San_freq",
"Reduction",#"Cv_San_Eff",
"Processing",#"Tr_St_P",
"Processing",#"Tr_P_St",
"Reduction",#"St_Compliance",
"Reduction",#"St_San_freq",
"Reduction",#"St_San_Eff",
"Processing",#"Tr_C_P",
"Processing",#"Tr_P_C",
"Reduction",#"C_Compliance",
"Reduction",#"C_San_freq",
"Reduction",# "C_San_Eff",
)
Sens_DF$Cateogry <-Cateogries
Cateogries<-c(
"Field Setup",# "InitialCont" ,
"Contamination Scen",#"ClusterSize",
"Reduction",#Time_CE_H",
"Reduction",#"Total_CE_H_Dieoff",
#Pre-cooling
"Time",#"Time_H_PC",
"Temperature","Temp_H_PC",
"Time","Time Precooling",
"Time","Temp Precooling",
"Intervention","Pre_cooling",
#Receiving
"Time",#"Time_Storage_R",
"Temperature",#"Temp_Storage_R",
#Processing Factor
"Reduction",#"PreWashRed",
"Reduction",#"PreWashYN",
"Reduction",#"WashingYN",
"Processing",#"Tr_Sh_P",
"Processing",#"Tr_P_Sh",
"Reduction",#"Sh_Compliance",
"Reduction",#"Sh_San_freq",
"Reduction",#"Sh_San_Eff",
"Processing",#"Tr_Cv_P",
"Processing",#"Tr_P_Cv",
"Reduction",#"Cv_Compliance",
"Reduction",#"Cv_San_freq",
"Reduction",#"Cv_San_Eff",
"Processing",#"Tr_St_P",
"Processing",#"Tr_P_St",
"Reduction",#"St_Compliance",
"Reduction",#"St_San_freq",
"Reduction",#"St_San_Eff",
"Processing",#"Tr_C_P",
"Processing",#"Tr_P_C",
"Reduction",#"C_Compliance",
"Reduction",#"C_San_freq",
"Reduction",# "C_San_Eff",
)
Cateogries<-c(
"Field Setup",# "InitialCont" ,
"Contamination Scen",#"ClusterSize",
"Reduction",#Time_CE_H",
"Reduction",#"Total_CE_H_Dieoff",
#Pre-cooling
"Time",#"Time_H_PC",
"Temperature","Temp_H_PC",
"Time","Time Precooling",
"Time","Temp Precooling",
"Intervention","Pre_cooling",
#Receiving
"Time",#"Time_Storage_R",
"Temperature",#"Temp_Storage_R",
#Processing Factor
"Reduction",#"PreWashRed",
"Reduction",#"PreWashYN",
"Reduction",#"WashingYN",
"Processing",#"Tr_Sh_P",
"Processing",#"Tr_P_Sh",
"Reduction",#"Sh_Compliance",
"Reduction",#"Sh_San_freq",
"Reduction",#"Sh_San_Eff",
"Processing",#"Tr_Cv_P",
"Processing",#"Tr_P_Cv",
"Reduction",#"Cv_Compliance",
"Reduction",#"Cv_San_freq",
"Reduction",#"Cv_San_Eff",
"Processing",#"Tr_St_P",
"Processing",#"Tr_P_St",
"Reduction",#"St_Compliance",
"Reduction",#"St_San_freq",
"Reduction",#"St_San_Eff",
"Processing",#"Tr_C_P",
"Processing",#"Tr_P_C",
"Reduction",#"C_Compliance",
"Reduction",#"C_San_freq",
"Reduction"# "C_San_Eff",
)
Sens_DF$Cateogry <-Cateogries
View(Sens_DF)
Cateogries<-c(
"Contamination Scen",# "InitialCont" ,
"Contamination Scen",#"ClusterSize",
"Reduction",#Time_CE_H",
"Reduction",#"Total_CE_H_Dieoff",
#Pre-cooling
"Time",#"Time_H_PC",
"Temperature",#"Temp_H_PC",
"Time",#"Time Precooling",
"Time",#"Temp Precooling",
"Intervention",#"Pre_cooling",
#Receiving
"Time",#"Time_Storage_R",
"Temperature",#"Temp_Storage_R",
#Processing Factor
"Reduction",#"PreWashRed",
"Reduction",#"PreWashYN",
"Reduction",#"WashingYN",
"Processing",#"Tr_Sh_P",
"Processing",#"Tr_P_Sh",
"Reduction",#"Sh_Compliance",
"Reduction",#"Sh_San_freq",
"Reduction",#"Sh_San_Eff",
"Processing",#"Tr_Cv_P",
"Processing",#"Tr_P_Cv",
"Reduction",#"Cv_Compliance",
"Reduction",#"Cv_San_freq",
"Reduction",#"Cv_San_Eff",
"Processing",#"Tr_St_P",
"Processing",#"Tr_P_St",
"Reduction",#"St_Compliance",
"Reduction",#"St_San_freq",
"Reduction",#"St_San_Eff",
"Processing",#"Tr_C_P",
"Processing",#"Tr_P_C",
"Reduction",#"C_Compliance",
"Reduction",#"C_San_freq",
"Reduction"# "C_San_Eff",
)
Sens_DF$Cateogry <-Cateogries
ggplot(data = PCC1$PRCC, aes(x=fct_reorder(rownames(PCC1$PRCC), abs(original)),y=original , color = Category))+
geom_bar(stat = "identity", position = "identity")+
geom_errorbar(aes(ymin=minci, ymax=maxci), width=.1,col="blue")+
ylab("Partial Correlation Coefficient")+
xlab("Model Input")+
ggtitle("Sensitivity Analysis on Final CFU in System")+
coord_flip()+
theme(plot.title = element_text(hjust = 0.5))+
theme(text = element_text(size=13))
ggplot(data = Sens_DF, aes(x=fct_reorder(rownames(PCC1$PRCC), abs(original)),y=original , color = Category))+
geom_bar(stat = "identity", position = "identity")+
geom_errorbar(aes(ymin=minci, ymax=maxci), width=.1,col="blue")+
ylab("Partial Correlation Coefficient")+
xlab("Model Input")+
ggtitle("Sensitivity Analysis on Final CFU in System")+
coord_flip()+
theme(plot.title = element_text(hjust = 0.5))+
theme(text = element_text(size=13))
Sens_DF$Cateogry <-Cateogries
View(Sens_DF)
ggplot(data = Sens_DF, aes(x=fct_reorder(rownames(PCC1$PRCC), abs(original)),y=original , color = Cateogry))+
geom_bar(stat = "identity", position = "identity")+
geom_errorbar(aes(ymin=minci, ymax=maxci), width=.1,col="blue")+
ylab("Partial Correlation Coefficient")+
xlab("Model Input")+
ggtitle("Sensitivity Analysis on Final CFU in System")+
coord_flip()+
theme(plot.title = element_text(hjust = 0.5))+
theme(text = element_text(size=13))
#8 Visuals , remaing the columns to that no error in ggplot
names(PCC1$PRCC)=c("original", "bias" ,"std.error", "minci","maxci")
#Ggplot, here is similar to a tornado plot. Also there are error bars on the 95th percentile
Sens_DF<-PCC1$PRCC
Sens_DF$Cateogry
Cateogries<-c(
"Contamination Scen",# "InitialCont" ,
"Contamination Scen",#"ClusterSize",
"Reduction",#Time_CE_H",
"Reduction",#"Total_CE_H_Dieoff",
#Pre-cooling
"Time",#"Time_H_PC",
"Temperature",#"Temp_H_PC",
"Time",#"Time Precooling",
"Time",#"Temp Precooling",
"Intervention",#"Pre_cooling",
#Receiving
"Time",#"Time_Storage_R",
"Temperature",#"Temp_Storage_R",
#Processing Factor
"Reduction",#"PreWashRed",
"Reduction",#"PreWashYN",
"Reduction",#"WashingYN",
"Processing",#"Tr_Sh_P",
"Processing",#"Tr_P_Sh",
"Reduction",#"Sh_Compliance",
"Reduction",#"Sh_San_freq",
"Reduction",#"Sh_San_Eff",
"Processing",#"Tr_Cv_P",
"Processing",#"Tr_P_Cv",
"Reduction",#"Cv_Compliance",
"Reduction",#"Cv_San_freq",
"Reduction",#"Cv_San_Eff",
"Processing",#"Tr_St_P",
"Processing",#"Tr_P_St",
"Reduction",#"St_Compliance",
"Reduction",#"St_San_freq",
"Reduction",#"St_San_Eff",
"Processing",#"Tr_C_P",
"Processing",#"Tr_P_C",
"Reduction",#"C_Compliance",
"Reduction",#"C_San_freq",
"Reduction"# "C_San_Eff",
)
Sens_DF$Cateogry <-Cateogries
ggplot(data = Sens_DF, aes(x=fct_reorder(rownames(PCC1$PRCC), abs(original)),y=original , color = Cateogry))+
geom_bar(stat = "identity", position = "identity")+
geom_errorbar(aes(ymin=minci, ymax=maxci), width=.1,col="blue")+
ylab("Partial Correlation Coefficient")+
xlab("Model Input")+
ggtitle("Sensitivity Analysis on Final CFU in System")+
coord_flip()+
theme(plot.title = element_text(hjust = 0.5))+
theme(text = element_text(size=13))
ggplot(data = Sens_DF, aes(x=fct_reorder(rownames(PCC1$PRCC), abs(original)),y=original , fill = Cateogry))+
geom_bar(stat = "identity", position = "identity")+
geom_errorbar(aes(ymin=minci, ymax=maxci), width=.1,col="blue")+
ylab("Partial Correlation Coefficient")+
xlab("Model Input")+
ggtitle("Sensitivity Analysis on Final CFU in System")+
coord_flip()+
theme(plot.title = element_text(hjust = 0.5))+
theme(text = element_text(size=13))
Cateogries<-c(
"Contamination Scen",# "InitialCont" ,
"Contamination Scen",#"ClusterSize",
"Time",#Time_CE_H",
"Reduction",#"Total_CE_H_Dieoff",
#Pre-cooling
"Time",#"Time_H_PC",
"Temperature",#"Temp_H_PC",
"Time",#"Time Precooling",
"Time",#"Temp Precooling",
"Intervention",#"Pre_cooling",
#Receiving
"Time",#"Time_Storage_R",
"Temperature",#"Temp_Storage_R",
#Processing Factor
"Reduction",#"PreWashRed",
"Reduction",#"PreWashYN",
"Reduction",#"WashingYN",
"Processing",#"Tr_Sh_P",
"Processing",#"Tr_P_Sh",
"Reduction",#"Sh_Compliance",
"Reduction",#"Sh_San_freq",
"Reduction",#"Sh_San_Eff",
"Processing",#"Tr_Cv_P",
"Processing",#"Tr_P_Cv",
"Reduction",#"Cv_Compliance",
"Reduction",#"Cv_San_freq",
"Reduction",#"Cv_San_Eff",
"Processing",#"Tr_St_P",
"Processing",#"Tr_P_St",
"Reduction",#"St_Compliance",
"Reduction",#"St_San_freq",
"Reduction",#"St_San_Eff",
"Processing",#"Tr_C_P",
"Processing",#"Tr_P_C",
"Reduction",#"C_Compliance",
"Reduction",#"C_San_freq",
"Reduction"# "C_San_Eff",
)
Sens_DF$Cateogry <-Cateogries
ggplot(data = Sens_DF, aes(x=fct_reorder(rownames(PCC1$PRCC), abs(original)),y=original , fill = Cateogry))+
geom_bar(stat = "identity", position = "identity")+
geom_errorbar(aes(ymin=minci, ymax=maxci), width=.1,col="blue")+
ylab("Partial Correlation Coefficient")+
xlab("Model Input")+
ggtitle("Sensitivity Analysis on Final CFU in System")+
coord_flip()+
theme(plot.title = element_text(hjust = 0.5))+
theme(text = element_text(size=13))
Data <- read.csv("SensitivityOut03-21.csv", stringsAsFactors = TRUE)
View(Data)
View(Data)
View(Data)
Data_x<-Data[-c(1,43,44)]
PCC1<-pcc(X = Data_x, y=Data$TotalCFUFP, rank =TRUE, conf = 0.8, nboot = 100)
library(ppcor)
library(sensitivity)
library(ggplot2)
library(randomForest)
library(forcats)
PCC1<-pcc(X = Data_x, y=Data$TotalCFUFP, rank =TRUE, conf = 0.8, nboot = 1000)
#8 Visuals , remaing the columns to that no error in ggplot
names(PCC1$PRCC)=c("original", "bias" ,"std.error", "minci","maxci")
#Ggplot, here is similar to a tornado plot. Also there are error bars on the 95th percentile
Sens_DF<-PCC1$PRCC
Sens_DF$Cateogry
Cateogries<-c(
"Contamination Scen",# "InitialCont" ,
"Contamination Scen",#"ClusterSize",
"Time",#Time_CE_H",
"Reduction",#"Total_CE_H_Dieoff",
#Pre-cooling
"Time",#"Time_H_PC",
"Temperature",#"Temp_H_PC",
"Time",#"Time Precooling",
"Time",#"Temp Precooling",
"Intervention",#"Pre_cooling",
#Receiving
"Time",#"Time_Storage_R",
"Temperature",#"Temp_Storage_R",
#Processing Factor
"Reduction",#"PreWashRed",
"Reduction",#"PreWashYN",
"Reduction",#"WashingYN",
"Reduction", #"ChSpray_eff"
"Processing",#"Tr_Sh_P",
"Processing",#"Tr_P_Sh",
"Reduction",#"Sh_Compliance",
"Reduction",#"Sh_San_freq",
"Reduction",#"Sh_San_Eff",
"Processing",#"Tr_Cv_P",
"Processing",#"Tr_P_Cv",
"Reduction",#"Cv_Compliance",
"Reduction",#"Cv_San_freq",
"Reduction",#"Cv_San_Eff",
"Processing",#"Tr_St_P",
"Processing",#"Tr_P_St",
"Reduction",#"St_Compliance",
"Reduction",#"St_San_freq",
"Reduction",#"St_San_Eff",
"Processing",#"Tr_C_P",
"Processing",#"Tr_P_C",
"Reduction",#"C_Compliance",
"Reduction",#"C_San_freq",
"Reduction",# "C_San_Eff",
"Time",
"Temperature",
"Time",
"Temperature",
"Time",
"Temperature"
)
Sens_DF$Cateogry <-Cateogries
ggplot(data = Sens_DF, aes(x=fct_reorder(rownames(PCC1$PRCC), abs(original)),y=original , fill = Cateogry))+
geom_bar(stat = "identity", position = "identity")+
geom_errorbar(aes(ymin=minci, ymax=maxci), width=.1,col="blue")+
ylab("Partial Correlation Coefficient")+
xlab("Model Input")+
ggtitle("Sensitivity Analysis on Final CFU in System")+
coord_flip()+
theme(plot.title = element_text(hjust = 0.5))+
theme(text = element_text(size=13))
View(Data)
View(Sens_DF)
Column_Names<-c(
"Initial Contamination",# "InitialCont" ,
"Cluster Size",#"ClusterSize",
"Time CE-H",#Time_CE_H",
"Total Pre-Harvest Die-off",#"Total_CE_H_Dieoff",
#Pre-cooling
"Time H-Pre-cooling",#"Time_H_PC",
"Temperature H-Pre-cooling",#"Temp_H_PC",
"Length Pre-cooling",#"Time Precooling",
"Teperature Pre-cooling",#"Temp Precooling",
"Pre-cooling ON",#"Pre_cooling",
#Receiving
"Time Storage- Receiving",#"Time_Storage_R",
"Storage Temperature",#"Temp_Storage_R",
#Processing Factor
"Pre-Wash Reduction",#"PreWashRed",
"Pre-Wash ON",#"PreWashYN",
"Chlorinated Wash ON",#"WashingYN",
"Pre-Wash Efficacy", #"ChSpray_eff"
"Tr_Sh_P",
"Tr_P_Sh",
"Sh_Compliance",
"Sh_San_freq",
"Sh_San_Eff",
"Tr_Cv_P",
"Tr_P_Cv",
"Cv_Compliance",
"Cv_San_freq",
"Cv_San_Eff",
"Tr_St_P",
"Tr_P_St",
"St_Compliance",
"St_San_freq",
"St_San_Eff",
"Tr_C_P",
"Tr_P_C",
"C_Compliance",
"C_San_freq",
"C_San_Eff",
"Time Post Processing Storage",
"Temperature Post P Storage",
"Time Transportation to C",
"Temperature Transportation to C",
"Time Consumer Storage",
"Temperature Consumer Storage"
)
rownames(Sens_DF)<-Column_Names
ggplot(data = Sens_DF, aes(x=fct_reorder(rownames(PCC1$PRCC), abs(original)),y=original , fill = Cateogry))+
geom_bar(stat = "identity", position = "identity")+
geom_errorbar(aes(ymin=minci, ymax=maxci), width=.1,col="blue")+
ylab("Partial Correlation Coefficient")+
xlab("Model Input")+
ggtitle("Sensitivity Analysis on Final CFU in System")+
coord_flip()+
theme(plot.title = element_text(hjust = 0.5))+
theme(text = element_text(size=13))
ggplot(data = Sens_DF, aes(x=fct_reorder(rownames(PCC1$PRCC), abs(original)),y=original , fill = Cateogry))+
geom_bar(stat = "identity", position = "identity")+
geom_errorbar(aes(ymin=minci, ymax=maxci), width=.1,col="blue")+
ylab("Partial Correlation Coefficient")+
xlab("Model Input")+
ggtitle("Sensitivity Analysis on Final CFU in System")+
coord_flip()+
theme(plot.title = element_text(hjust = 0.5))+
theme(text = element_text(size=13))
ggplot(data = Sens_DF, aes(x=fct_reorder(rownames(Sens_DF), abs(original)),y=original , fill = Cateogry))+
geom_bar(stat = "identity", position = "identity")+
geom_errorbar(aes(ymin=minci, ymax=maxci), width=.1,col="blue")+
ylab("Partial Correlation Coefficient")+
xlab("Model Input")+
ggtitle("Sensitivity Analysis on Final CFU in System")+
coord_flip()+
theme(plot.title = element_text(hjust = 0.5))+
theme(text = element_text(size=13))
View(Sens_DF)
