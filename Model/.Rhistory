Time = 175
(rate*Time)
Temp<-4.7
#rate= ((bval*(Temp-T_min))*(1-exp(Coef*(Temp-Tmax))))^(2/2.303)
rate = (bval*(Temp-T_min))^2/2.303
print(rate)
Time = 175
(rate*Time)
Initial = 4.01
Final =
Fina-Initial
Temp<-4.7
#rate= ((bval*(Temp-T_min))*(1-exp(Coef*(Temp-Tmax))))^(2/2.303)
rate = (bval*(Temp-T_min))^2/2.303
print(rate)
Time = 175
(rate*Time)
#rate= ((bval*(Temp-T_min))*(1-exp(Coef*(Temp-Tmax))))^(2/2.303)
rate = (bval*(Temp-T_min))^2/2.303
print(rate)
Temp<-2.1
#rate= ((bval*(Temp-T_min))*(1-exp(Coef*(Temp-Tmax))))^(2/2.303)
rate = (bval*(Temp-T_min))^2/2.303
print(rate)
Temp<-2.7
#rate= ((bval*(Temp-T_min))*(1-exp(Coef*(Temp-Tmax))))^(2/2.303)
rate = (bval*(Temp-T_min))^2/2.303
print(rate)
Time = 175
(rate*Time)
#P Putida
bval = 0.03772 #+-0.0002
T_min = -6.1
Coef= 0.1719#+-1.22 C
Tmax<-41.2
Temp<-2.7
#rate= ((bval*(Temp-T_min))*(1-exp(Coef*(Temp-Tmax))))^(2/2.303)
rate = (bval*(Temp-T_min))^2/2.303
print(rate)
Time = 175
(rate*Time)
#P Putida
bval = 0.03347 #+-0.0002
T_min = -7.7
Coef= 0.1719#+-1.22 C
Tmax<-41.2
Temp<-2.7
#rate= ((bval*(Temp-T_min))*(1-exp(Coef*(Temp-Tmax))))^(2/2.303)
rate = (bval*(Temp-T_min))^2/2.303
print(rate)
Time = 175
(rate*Time)
Temp<-10
#rate= ((bval*(Temp-T_min))*(1-exp(Coef*(Temp-Tmax))))^(2/2.303)
rate = (bval*(Temp-T_min))^2/2.303
print(rate)
#rate= ((bval*(Temp-T_min))*(1-exp(Coef*(Temp-Tmax))))^(2/2.303)
rate = (bval*(Temp-T_min))^2*log10(2)
print(rate)
Temp<-15
#rate= ((bval*(Temp-T_min))*(1-exp(Coef*(Temp-Tmax))))^(2/2.303)
rate = (bval*(Temp-T_min))^2*log10(2)
print(rate)
Temp<-25
#rate= ((bval*(Temp-T_min))*(1-exp(Coef*(Temp-Tmax))))^(2/2.303)
rate = (bval*(Temp-T_min))^2*log10(2)
print(rate)
Time = 175
Temp<-4
#rate= ((bval*(Temp-T_min))*(1-exp(Coef*(Temp-Tmax))))^(2/2.303)
rate = (bval*(Temp-T_min))^2*log10(2)
print(rate)
Time = 175
(rate*Time)
log(10)
adrate = rate/log(10)
print(rate)
Temp<-5
#rate= ((bval*(Temp-T_min))*(1-exp(Coef*(Temp-Tmax))))^(2/2.303)
rate = (bval*(Temp-T_min))^2
adrate = rate/log(10)
print(rate)
Time = 175
(rate*Time)
Temp<-5
#rate= ((bval*(Temp-T_min))*(1-exp(Coef*(Temp-Tmax))))^(2/2.303)
rate = (bval*(Temp-T_min))^2
adrate = rate/log(10)
print(adrate)
Time = 175
(adrate*Time)
log(10)
log(2)
#rate= ((bval*(Temp-T_min))*(1-exp(Coef*(Temp-Tmax))))^(2/2.303)
rate = (bval*(Temp-T_min))^2
print(rate)
print(adrate)
print(adrate2)
adrate2 = rate*ln(2)
print(adrate2)
adrate2 = rate*log(2)
print(adrate2)
#rate= ((bval*(Temp-T_min))*(1-exp(Coef*(Temp-Tmax))))^(2/2.303)
rate = (bval*(Temp-T_min))^2
print(rate)
adrate = rate/log(10)
print(adrate)
adrate2 = rate*log(2)
print(adrate2)
log(10)
#rate= ((bval*(Temp-T_min))*(1-exp(Coef*(Temp-Tmax))))^(2/2.303)
rate = (bval*(Temp-T_min))^2/2.303
print(rate)
#rate= ((bval*(Temp-T_min))*(1-exp(Coef*(Temp-Tmax))))^(2/2.303)
rate = (bval*(Temp-T_min))^2
print(rate)
adrate = rate/log(10)
print(adrate)
adrate2 = rate*log(2)
print(adrate2)
log(2)
adrate2 = rate*log10(2)
print(adrate2)
adrate2 = rate*log(2)
print(adrate2)
#Validation of their model, obtaining similar Histograms as theirs for spoilage
shelf_life<-c()
for (i in 1:1000){
Temp<-rnorm(1,4.4,2)
Growth_variability <- 1-(rnorm(1,0,17)/100)
Initial_pop <- rtriang(1,0,1,4)
GrowthNeedforspoilage<-7-Initial_pop
Tmin <- -1.19
bval <-0.03578
growthRate <- ((Temp-Tmin)*bval)^2
Adjusted_GrowthRate<-growthRate+Growth_variability
LogGrowthRate<-Adjusted_GrowthRate*log10(2)
Shelflifedays<-(GrowthNeedforspoilage/LogGrowthRate)
shelf_life<-c(shelf_life,Shelflifedays)
}
hist(shelf_life,breaks = 100)
abline(v=14, col = "red")
mean(shelf_life)
log10(20000)
log10(1000000)
bval = 0.03347 #+-0.0002
T_min = -7.7
Temp 4
rate = (bval*(Temp-T_min))^2
bval <- 0.03347 #+-0.0002
T_min <- -7.7
Temp<- 4
rate = (bval*(Temp-T_min))^2
lagtime = 1/((bval*(Temp-T_min))^2)
lagtime
rate
Time<-10
rate = (bval*(Temp-T_min))^2
Spoilage<-rate*Time
Spoilage
rate/24
Temp<- 10
rate = (bval*(Temp-T_min))^2
rate/24
Temp<- 25
rate = (bval*(Temp-T_min))^2
rate*Time
Time<-3
rate*Time
Temp<- 25
rate = 0.1709*(Temp+6.1)*(1-exp(0.1723*(Temp-41.2)))*(0.996-0.977)
rate
rate*Time
Time<-24
rate = 0.1709*(Temp+6.1)*(1-exp(0.1723*(Temp-41.2)))*(0.996-0.977)
rate*Time
rate = 0.1709*(Temp+6.1)*(1-exp(0.1723*(Temp-41.2)))*(0.996-0.977)
Temp = 25
Temp = 25
Time = 24
rate = 0.1709*(Temp+6.1)*(1-exp(0.1723*(Temp-41.2)))*(0.996-0.977)
rate*Time
rate = 0.1539*(Temp+7.6)*(0.996-0.947)
rate*Time
rate = 0.1539*(Temp+7.6)*0.996-0.947
rate*Time
rate = 0.1539*(Temp+7.6)*(0.996-0.947)
rate*Time
Temp<- 4
rate = (bval*(Temp-T_min))^2
rate
Temp<- 4
rate = (bval*(Temp-T_min))^2
rate
rate = (bval*(Temp-T_min))^2/2.303
rate
Temp<- 15
rate = (bval*(Temp-T_min))^2/2.303
rate
Temp<- 29
rate = (bval*(Temp-T_min))^2/2.303
rate
T_min <- -9.1
Temp<- 29
rate = (bval*(Temp-T_min))^2/2.303
rate
T_min <- -7.7
Temp<- 5
rate = (bval*(Temp-T_min))^2/2.303
rate
Temp<- 4
rate = (bval*(Temp-T_min))^2/2.303
rate
LagTime = 1/rate
LagTime
Temp<- 25
rate = (bval*(Temp-T_min))^2/2.303
rate
LagTime = 1/rate
LagTime
bval <-0.023
Tmin <--5.647
#ratemax<-(bval*(Temp-T_min))
sqrtrate<-c()
for (i in -5:35){
ratemax<-(bval*(i-T_min))
sqrtrate<-c(sqrtrate,ratemax)
}
sqrtrate<-c()
Timeseq<-seq(-5,35)
for (i in Timeseq){
ratemax<-(bval*(i-T_min))
sqrtrate<-c(sqrtrate,ratemax)
}
plot(x = Timeseq, y = sqrtrate)
sqrtrate<-c()
Timeseq<-seq(-5,35)
for (i in Timeseq){
ratemax<-(bval*(i-T_min))^2
sqrtrate<-c(sqrtrate,ratemax)
}
plot(x = Timeseq, y = sqrtrate)
#Ratworsky
bval <-0.023
Tmin <--5.647
Temp<-4
ratemax<-(bval*(Temp-T_min))
ratemax
#Ratworsky
bval <-0.023
Tmin <--5.647
Temp<-4
ratemax<-(bval*(Temp-T_min))^2
ratemax
Temp<-4
ratemax<-(bval*(Temp-T_min))
ratemax
#Ratworsky
bval <-0.023
Tmin <--5.647
Temp<-4
ratemax<-(bval*(Temp-T_min))
ratemax
sqrtrate<-c()
sqrtrate<-c()
Timeseq<-seq(-5,35)
for (i in Timeseq){
ratemax<-(bval*(i-T_min))
sqrtrate<-c(sqrtrate,ratemax)
}
plot(x = Timeseq, y = sqrtrate)
Temp<-4
ratemax<-(bval*(Temp-T_min))^2
ratemax
ratemax<-(bval*(Temp-T_min))^2/2.303
ratemax
#Ratworsky
bval <-0.023
Tmin <--5.647
Temp<-10
ratemax<-(bval*(Temp-T_min))^2/2.303
ratemax
#Ratworsky
bval <-0.023
Tmin <--5.647
Temp<-10
ratemax<-(bval*(Temp-T_min))^2/log(10)
ratemax
bval <- 0.03347 #+-0.0002
T_min <- -7.7
Temp<- 4
Time<-24
Temp<- 25
rate = (bval*(Temp-T_min))^2/2.303
rate
LagTime = 1/rate
LagTime
rate
Time<-24
Temp<- 4
rate = (bval*(Temp-T_min))^2/2.303
rate
LagTime = 1/rate
LagTime
1/0.35
1/0.035
1/1.1
runif(1,20,30)
runif(1,20,30)
library(epiR)
setwd("~/GitHub/CPS-Farm-to-Facility/Model")
Data = read.csv("SensitivityOut.csv")
Data <- read.csv("SensitivityOut.csv")
epi.prcc(Data, sided.test = 2, conf.level = 0.95)
epi.prcc(Data
epi.prcc(Data)
epi.prcc(data= Data)
epi.prcc(dat= Data)
x1 <- rnorm(n = 10, mean = 120, sd = 130)
x2 <- rnorm(n = 10, mean = 80, sd = 5)
x3 <- rnorm(n = 10, mean = 40, sd = 20)
y <- 2 + (0.5 * x1) - (1.7 * x2) + (0.2 * x3)
dat.df01 <- data.frame(x1 = x1, x2 = x2, x3 = x3, y = y)
epi.prcc(dat.df01, sided.test = 2, conf.level = 0.95)
epi.prcc(dat.df01, sided.test = 2, conf.level = 0.95)
epi.prcc(dat.df01, sided.test = 2)
library(ppcor)
pcor(Data, method = "pearson")
Data <- read.csv("SensitivityOut.csv", stringsAsFactors = TRUE)
pcor(Data, method = "pearson")
str(Data)
Data<-Data[-1]
str(Data)
pcor(Data, method = "pearson")
Data <- read.csv("SensitivityOut.csv", stringsAsFactors = TRUE)
str(Data)
Data<-Data[-c(1,8]
Data<-Data[-c(1,8)]
str(Data)
pcor(Data, method = "pearson")
corelaion<-pcor(Data, method = "pearson")
View(corelaion)
corelaion$estimate
corelaion<-pcor(Data)
corelaion$estimate
library(sensitivity)
Data <- read.csv("SensitivityOut.csv", stringsAsFactors = TRUE)
Data<-Data[-1]
View(Data)
pcc(x = Data[,1:7], y=Data$TotalCFUFP, nboot = 100, conf = 0.95)
pcc(X = Data[,1:7], y=Data$TotalCFUFP, nboot = 100, conf = 0.95)
plot(PCC1)
PCC1<-pcc(X = Data[,1:7], y=Data$TotalCFUFP, nboot = 100, conf = 0.95)
plot(PCC1)
PCC1<-pcc(X = Data[,1:7], y=Data$TotalCFUFP, nboot = 100, conf = 0.95)
plot(PCC1)
Data <- read.csv("SensitivityOut.csv", stringsAsFactors = TRUE)
Data<-Data[-c(1,8)]
PCC1<-pcc(X = Data[,1:7], y=Data$TotalCFUFP, nboot = 100, conf = 0.95)
plot(PCC1)
PCC1<-pcc(X = Data[,1:7], y=Data$TotalCFUFP, rank =TRUE, nboot = 100, conf = 0.95)
PCC1<-pcc(X = Data[,1:7], y=Data$TotalCFUFP, rank =TRUE, conf = 0.95)
plot(PCC1)
PCC1<-pcc(X = Data[,1:7], y=Data$TotalCFUFP, rank =TRUE, conf = 0.95)
plot(PCC1)
PCC1
#8 Visuals , remaing the columns to that no error in ggplot
names(PCC1$PRCC)=c("original", "bias" ,"std.error", "minci","maxci")
#Ggplot, here is similar to a tornado plot. Also there are error bars on the 95th percentile
ggplot(data = PCC1$PRCC, aes(x=rownames(Pcc2$PRCC),y=original ))+
geom_bar(stat = "identity", position = "identity")+
geom_errorbar(aes(ymin=minci, ymax=maxci), width=.1,col="blue")+
ylab("Partial Correlation Coefficient")+
xlab("Action")+
ggtitle("Sensitivity Analysis Individual Items: Final Contamination PFU/Item")+
scale_x_discrete(labels=c("Initial Contamination", "Shared", "Times in ST", "Total services","Overall Transfer From Touches", "Number of Touches")) +
coord_flip()+
theme(plot.title = element_text(hjust = 0.5))+
theme(text = element_text(size=13))
ggplot(data = PCC1$PRCC, aes(x=rownames(PCC1$PRCC),y=original ))+
geom_bar(stat = "identity", position = "identity")+
geom_errorbar(aes(ymin=minci, ymax=maxci), width=.1,col="blue")+
ylab("Partial Correlation Coefficient")+
xlab("Action")+
ggtitle("Sensitivity Analysis Individual Items: Final Contamination PFU/Item")+
scale_x_discrete(labels=c("Initial Contamination", "Shared", "Times in ST", "Total services","Overall Transfer From Touches", "Number of Touches")) +
coord_flip()+
theme(plot.title = element_text(hjust = 0.5))+
theme(text = element_text(size=13))
library(ggplot2)
ggplot(data = PCC1$PRCC, aes(x=rownames(PCC1$PRCC),y=original ))+
geom_bar(stat = "identity", position = "identity")+
geom_errorbar(aes(ymin=minci, ymax=maxci), width=.1,col="blue")+
ylab("Partial Correlation Coefficient")+
xlab("Action")+
ggtitle("Sensitivity Analysis Individual Items: Final Contamination PFU/Item")+
scale_x_discrete(labels=c("Initial Contamination", "Shared", "Times in ST", "Total services","Overall Transfer From Touches", "Number of Touches")) +
coord_flip()+
theme(plot.title = element_text(hjust = 0.5))+
theme(text = element_text(size=13))
PCC1$PRCC
PCC1<-pcc(X = Data[,1:7], y=Data$TotalCFUFP, rank =TRUE, conf = 0.95, nboot = 10)
PCC1<-pcc(X = Data[,1:7], y=Data$TotalCFUFP, rank =TRUE, conf = 0.95, nboot = 100)
PCC1<-pcc(X = Data[,1:7], y=Data$TotalCFUFP, rank =TRUE, conf = 0.95, nboot = 10)
plot(PCC1)
PCC1$PRCC
PCC1$PRCC
#8 Visuals , remaing the columns to that no error in ggplot
names(PCC1$PRCC)=c("original", "bias" ,"std.error", "minci","maxci")
#Ggplot, here is similar to a tornado plot. Also there are error bars on the 95th percentile
ggplot(data = PCC1$PRCC, aes(x=rownames(PCC1$PRCC),y=original ))+
geom_bar(stat = "identity", position = "identity")+
geom_errorbar(aes(ymin=minci, ymax=maxci), width=.1,col="blue")+
ylab("Partial Correlation Coefficient")+
xlab("Action")+
ggtitle("Sensitivity Analysis Individual Items: Final Contamination PFU/Item")+
scale_x_discrete(labels=c("Initial Contamination", "Shared", "Times in ST", "Total services","Overall Transfer From Touches", "Number of Touches")) +
coord_flip()+
theme(plot.title = element_text(hjust = 0.5))+
theme(text = element_text(size=13))
ggplot(data = PCC1$PRCC, aes(x=rownames(PCC1$PRCC),y=original ))+
geom_bar(stat = "identity", position = "identity")+
geom_errorbar(aes(ymin=minci, ymax=maxci), width=.1,col="blue")+
ylab("Partial Correlation Coefficient")+
xlab("Action")+
ggtitle("Sensitivity Analysis Individual Items: Final Contamination PFU/Item")+
coord_flip()+
theme(plot.title = element_text(hjust = 0.5))+
theme(text = element_text(size=13))
Data <- read.csv("SensitivityOut.csv", stringsAsFactors = TRUE)
Data<-Data[-c(1,8)]
PCC1<-pcc(X = Data[,1:7], y=Data$TotalCFUFP, rank =TRUE, conf = 0.95, nboot = 10)
plot(PCC1)
#8 Visuals , remaing the columns to that no error in ggplot
names(PCC1$PRCC)=c("original", "bias" ,"std.error", "minci","maxci")
ggplot(data = PCC1$PRCC, aes(x=rownames(PCC1$PRCC),y=original ))+
geom_bar(stat = "identity", position = "identity")+
geom_errorbar(aes(ymin=minci, ymax=maxci), width=.1,col="blue")+
ylab("Partial Correlation Coefficient")+
xlab("Action")+
ggtitle("Sensitivity Analysis Individual Items: Final Contamination PFU/Item")+
coord_flip()+
theme(plot.title = element_text(hjust = 0.5))+
theme(text = element_text(size=13))
PCC1<-pcc(X = Data[,1:7], y=Data$TotalCFUFP, rank =TRUE, conf = 0.95, nboot = 100)
#8 Visuals , remaing the columns to that no error in ggplot
names(PCC1$PRCC)=c("original", "bias" ,"std.error", "minci","maxci")
#Ggplot, here is similar to a tornado plot. Also there are error bars on the 95th percentile
ggplot(data = PCC1$PRCC, aes(x=rownames(PCC1$PRCC),y=original ))+
geom_bar(stat = "identity", position = "identity")+
geom_errorbar(aes(ymin=minci, ymax=maxci), width=.1,col="blue")+
ylab("Partial Correlation Coefficient")+
xlab("Action")+
ggtitle("Sensitivity Analysis Individual Items: Final Contamination PFU/Item")+
coord_flip()+
theme(plot.title = element_text(hjust = 0.5))+
theme(text = element_text(size=13))
PCC1<-pcc(X = Data[,1:7], y=Data$TotalCFUFP, rank =TRUE, conf = 0.95, nboot = 1000)
plot(PCC1)
#8 Visuals , remaing the columns to that no error in ggplot
names(PCC1$PRCC)=c("original", "bias" ,"std.error", "minci","maxci")
ggplot(data = PCC1$PRCC, aes(x=rownames(PCC1$PRCC),y=original ))+
geom_bar(stat = "identity", position = "identity")+
geom_errorbar(aes(ymin=minci, ymax=maxci), width=.1,col="blue")+
ylab("Partial Correlation Coefficient")+
xlab("Action")+
ggtitle("Sensitivity Analysis Individual Items: Final Contamination PFU/Item")+
coord_flip()+
theme(plot.title = element_text(hjust = 0.5))+
theme(text = element_text(size=13))
install.packages("randomForest")
library(randomForest)
Data <- read.csv("SensitivityOut.csv", stringsAsFactors = TRUE)
Data<-Data[-c(1)]
PCC1<-pcc(X = Data[,1:7], y=Data$TotalCFUFP, rank =TRUE, conf = 0.95, nboot = 1000)
plot(PCC1)
#8 Visuals , remaing the columns to that no error in ggplot
names(PCC1$PRCC)=c("original", "bias" ,"std.error", "minci","maxci")
ggplot(data = PCC1$PRCC, aes(x=rownames(PCC1$PRCC),y=original ))+
geom_bar(stat = "identity", position = "identity")+
geom_errorbar(aes(ymin=minci, ymax=maxci), width=.1,col="blue")+
ylab("Partial Correlation Coefficient")+
xlab("Action")+
ggtitle("Sensitivity Analysis Individual Items: Final Contamination PFU/Item")+
coord_flip()+
theme(plot.title = element_text(hjust = 0.5))+
theme(text = element_text(size=13))
PCC1<-pcc(X = Data[,1:8], y=Data$TotalCFUFP, rank =TRUE, conf = 0.95, nboot = 1000)
plot(PCC1)
PCC1<-pcc(X = Data[,1:7], y=Data$TotalCFUFP, rank =TRUE, conf = 0.95, nboot = 1000)
plot(PCC1)
ggplot(data = PCC1$PRCC, aes(x=rownames(PCC1$PRCC),y=original ))+
geom_bar(stat = "identity", position = "identity")+
geom_errorbar(aes(ymin=minci, ymax=maxci), width=.1,col="blue")+
ylab("Partial Correlation Coefficient")+
xlab("Action")+
ggtitle("Sensitivity Analysis Individual Items: Final Contamination PFU/Item")+
coord_flip()+
theme(plot.title = element_text(hjust = 0.5))+
theme(text = element_text(size=13))
#8 Visuals , remaing the columns to that no error in ggplot
names(PCC1$PRCC)=c("original", "bias" ,"std.error", "minci","maxci")
#Ggplot, here is similar to a tornado plot. Also there are error bars on the 95th percentile
ggplot(data = PCC1$PRCC, aes(x=rownames(PCC1$PRCC),y=original ))+
geom_bar(stat = "identity", position = "identity")+
geom_errorbar(aes(ymin=minci, ymax=maxci), width=.1,col="blue")+
ylab("Partial Correlation Coefficient")+
xlab("Action")+
ggtitle("Sensitivity Analysis Individual Items: Final Contamination PFU/Item")+
coord_flip()+
theme(plot.title = element_text(hjust = 0.5))+
theme(text = element_text(size=13))
